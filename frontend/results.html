<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <style>
        .container {
            padding: 30px;
        }

        .card {
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
        }

        .card:hover {
            box-shadow: 0 4px 4px rgba(0, 0, 0, 0.2);
        }

        .card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
        }

        .card h3 {
            margin-top: 10px;
            font-size: 18px;
            font-weight: bold;
        }

        .card p {
            font-size: 14px;
            margin: 5px 0;
        }


        .card .cost {
            color: #ff6b6b;
            font-weight: bold;
        }

        .card .revenue {
            color: #2ecc71;
            font-weight: bold;
        }

        .card button {
            margin-top: 10px;
            padding: 10px 20px;
            background-color: #2ecc71;
            border: none;
            color: #fff;
            font-size: 14px;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
        }

        .col-md-4{
            padding-bottom: 10px;
        }

        .navbar {
            background-color: #343a40;
            font-family: 'Philly Sans', sans-serif;
            color: white;
            text-align: center;
            height: 70px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
        }

        .navbar img {
            max-height: 60px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .navbar-nav {
			display: flex;
			align-items: center;
			margin: 0;
			flex-grow: 1;
		}

		.navbar-nav:first-child {
			margin-right: auto;
		}

		.navbar-nav:last-child {
			margin-left: auto;
		}


        .nav-item {
            margin: 0 10px;
        }

        .navbar-nav > .nav-item:first-child {
            margin-right: auto;
        }

        .navbar-nav > .nav-item:last-child {
            margin-left: auto;
        }

        .username-btn {
            background-color: yellow;
            color: black;
            border: none;
            margin-left: 5px;
            padding: 5px 10px;
            font-weight: bold;
        }

        .username-btn:hover {
           background-color: yellow;
		   color: black;
		   cursor: pointer;
	    }
</style>

</head>
<body>

    <nav class="navbar navbar-expand-lg">
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<img src="logo.png" alt="logo">
		<div class="collapse navbar-collapse" id="navbarNav">
			<ul class="navbar-nav">
				<li class="nav-item">
					<button type="button" class="btn btn-link text-white"> < Previous Result</button>
				</li>
				<li class="nav-item">
					<button class="username-btn" id="user-btn" onclick="logout()"></button>
				</li>
			</ul>
			<div class="ml-auto">
				<button type="button" class="btn btn-link text-white">Next Result ></button>
			</div>
		</div>
	</nav>





	
	<div class="container">
	</div>
	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <div class="main-project">
                    <img>
                    <h3>Detected as</h3>
                    <div id="img_labels">Labels</div>
                </div>
            </div>
            <div class="col-md-8">
                <h3>Where to Buy</h3>
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <img>
                            <h3>{{ products[0][0] }}</h3>
                            <p>Cost: <span class="cost">{{ products[2][0] }}</span></p>
                            <p>Rating: <span class="revenue">{{ products[3][0] }}</span></p>
                            <a href="{{ products[4][0] }}" class="btn btn-primary">BUY</a>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <img src="{{ products[1][1] }}" >
                            <h3>{{ products[0][1] }}</h3>
                            <p>Cost: <span class="cost">{{ products[2][1] }}</span></p>
                            <p>Rating: <span class="revenue">{{ products[3][1] }}</span></p>
                            <a href="{{ products[4][1] }}" class="btn btn-primary">BUY</a>
                        </div>
                    </div>
				</div>
				<h3>Other suggestions</h3>
				
				<div class="row">
					<div class="col-md-4">
						<div class="card">
							<img src="{{ products[1][i] }}" >
							<h3>{{ products[0][i] }}</h3>
							<p>Cost: <span class="cost">{{ products[2][i] }}</span></p>
							<p>Rating: <span class="revenue">{{ products[3][i] }}</span></p>
							<a href="{{ products[4][i] }}" class="btn btn-primary">BUY</a>
						</div>
					</div>
					
					<div class="col-md-4">
						<div class="card">
							<img src="{{ products[1][i] }}" >
							<h3>{{ products[0][i] }}</h3>
							<p>Cost: <span class="cost">{{ products[2][i] }}</span></p>
							<p>Rating: <span class="revenue">{{ products[3][i] }}</span></p>
							<a href="{{ products[4][i] }}" class="btn btn-primary">BUY</a>
						</div>
					</div>
					
					<div class="col-md-4">
						<div class="card">
							<img src="{{ products[1][i] }}" >
							<h3>{{ products[0][i] }}</h3>
							<p>Cost: <span class="cost">{{ products[2][i] }}</span></p>
							<p>Rating: <span class="revenue">{{ products[3][i] }}</span></p>
							<a href="{{ products[4][i] }}" class="btn btn-primary">BUY</a>
						</div>
					</div>
		
				</div>
			</div>
		</div>
    </div>
	<script>

	// Check if the "clothinguser" value exists in the local storage
	const username = localStorage.getItem('clothinguser');
	page = 1;

	if (!localStorage.getItem('clothinguser')) 
	{
	  // If it doesn't exist, redirect to login.html
	  window.location.href = "login.html";
	}

	const sessionButton = document.getElementById("user-btn");

	sessionButton.textContent = "Logged in as: " + username;

	sessionButton.addEventListener('mouseover', function() {
	  sessionButton.textContent = 'Log Out';
	});

	sessionButton.addEventListener('mouseout', function() {
	  sessionButton.textContent = "Logged in as: " + username;
	});

	function logout(){
		localStorage.removeItem('clothinguser');
		window.location.href = 'login.html';
	}

	function populatePage() {
		// Update the main product image
		document.querySelector('.main-project img').setAttribute('src', products[5]);
		
		document.getElementById("img_labels").textContent = products[6].join(" ").replace(/(?:^|\s)\S/g, function(firstChar) {return firstChar.toUpperCase();});
		
		// Update the suggested products
		const suggestedProducts = document.querySelectorAll('.card');
		for (let i = 0; i < suggestedProducts.length; i++) {
			const img = suggestedProducts[i].querySelector('img');
			img.setAttribute('src', products[1][i]);
			const title = suggestedProducts[i].querySelector('h3');
			title.textContent = products[0][i];
			const cost = suggestedProducts[i].querySelector('.cost');
			cost.textContent = products[2][i];
			const rating = suggestedProducts[i].querySelector('.revenue');
			rating.textContent = products[3][i];
			const buyLink = suggestedProducts[i].querySelector('a');
			buyLink.setAttribute('href', products[4][i]);
		}
	}

	// Define the URL to send the request to
	const url = 'https://p0dhnmes8f.execute-api.us-east-1.amazonaws.com/getter1/search';

	// Make the Ajax GET request
	$.ajax({
		url: url,
		type: 'GET',
		data: {
		  user: username,
		  page: "2"
		},
		headers: {
		  "x-api-key": "XtG9gjlimX1sT0xobg4VC47fq98QGzZL5qwDqQil"
		},
		success: function(response) {
			// Store the received response in the products variable
			products = response;
			
			console.log(products[0])
			
			// Populate the page with the received response
			populatePage();
		}

	});

</script>

</body>
